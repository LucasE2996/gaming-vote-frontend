(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{31:function(e,t,a){e.exports=a.p+"static/media/wintaylor_logo.ddd71003.svg"},36:function(e,t,a){e.exports=a(70)},58:function(e,t,a){},59:function(e,t,a){},60:function(e,t,a){},61:function(e,t,a){},66:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),o=a.n(c),u=a(13),s=a(9),l=a(6),i=a.n(l),m=a(10),d=a(8),p=a(30),f=a.n(p).a.create({baseURL:"http://localhost:3000"}),h=(a(58),a(31)),b=a.n(h);var v=function(e){var t=e.history,a=Object(n.useState)(""),c=Object(d.a)(a,2),o=c[0],u=c[1],s=Object(n.useState)(");"),l=Object(d.a)(s,2),p=l[0],h=l[1],v=Object(n.useState)({display:"none"}),E=Object(d.a)(v,2),g=E[0],y=E[1];function k(){return(k=Object(m.a)(i.a.mark(function e(a){var n,r,c,u;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),e.next=3,f.post("sessions",{email:o,password:p}).catch(function(e){console.error(e)});case 3:if(n=e.sent){e.next=7;break}return y({display:"block"}),e.abrupt("return");case 7:r=n.data,c=r.user,u=r.token,y({display:"none"}),localStorage.setItem("token",u),"wintaylorAdmin426"===c.name?t.push("/admin"):t.push("/main/".concat(c.id));case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}return Object(n.useEffect)(function(){var e=localStorage.getItem("user");e&&t.push("/main/".concat(e))},[t]),r.a.createElement("div",{className:"login-container"},r.a.createElement("h2",null," Game Voting ")," ",r.a.createElement("img",{src:b.a,alt:"Wintaylor Logo"}),r.a.createElement("form",{onSubmit:function(e){return k.apply(this,arguments)}},r.a.createElement("input",{className:"box",type:"text",placeholder:"Enter with your business email",onChange:function(e){return u(e.target.value)},required:!0}),r.a.createElement("div",{className:"error-box",style:g},r.a.createElement("p",null," Invalid password or email ")),r.a.createElement("input",{className:"box",type:"password",placeholder:"Password",onChange:function(e){return h(e.target.value)},required:!0}),r.a.createElement("button",{className:"box",type:"submit"},"Login")))};a(59),a(60);var E=function(e){var t=e.data,a=t._id,n=t.image,c=t.hasVote;return r.a.createElement("li",{className:"item-container"},r.a.createElement("img",{src:""+n,alt:"Game poster"}),r.a.createElement("button",{className:"button",style:c?{backgroundColor:"#ed5565"}:{backgroundColor:"#1ab394"},onClick:function(t){return e.eventHandler(a)}},c?"Roll back vote":"Vote"))},g=(a(61),a(32)),y=a(33);var k=function(e){var t=e.closeHandler,a=e.data,n=a.status?"active":"inactive";return r.a.createElement("div",{className:"flashmessage-container ".concat(n)},r.a.createElement("h5",null,a.message),r.a.createElement(g.a,{className:"icon",icon:y.a,onClick:function(){return t()}}))};var w=function(e){var t=e.match,a=e.history,c=Object(n.useState)([]),o=Object(d.a)(c,2),u=o[0],s=o[1],l=Object(n.useState)({status:!1}),p=Object(d.a)(l,2),h=p[0],b=p[1];function v(){return(v=Object(m.a)(i.a.mark(function e(a){var n,r,c,o;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.find(function(e){return e._id===a})){e.next=3;break}return e.abrupt("return");case 3:if(r=localStorage.getItem("token")){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,f.post("user/".concat(n._id,"/vote"),null,{headers:{user_id:t.params.id,Authorization:"Bearer ".concat(r)}}).catch(function(e){e.message.includes("405")?b({message:"You cannot vote in more than 3 games",status:!0}):b({message:"Ops, something went wrong :(",status:!0})});case 8:(c=e.sent)&&(o=u.map(function(e){return n===e&&(e.hasVote=c.data.userVoted),e}),s(o));case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}Object(n.useEffect)(function(){function e(){return(e=Object(m.a)(i.a.mark(function e(){var a,n,r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=localStorage.getItem("token"),e.next=3,f.get("game",{headers:{Authorization:"Bearer ".concat(a)}});case 3:n=e.sent,r=n.data.map(function(e){var a=e.votes.find(function(e){return e.includes(t.params.id)});return e.hasVote=!!a,e}),s(r);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t.params.id]);var g=u.map(function(e){return r.a.createElement(E,{key:e._id,data:e,eventHandler:function(){return function(e){return v.apply(this,arguments)}(e._id)}})});return r.a.createElement("main",{className:"main-container"},r.a.createElement("h2",null,"choose 3 games only!"),r.a.createElement("button",{className:"sign-out",onClick:function(){return localStorage.clear(),void a.push("/")}},"Sign Out"),r.a.createElement("ul",null," ",g," "),r.a.createElement(k,{data:h,closeHandler:function(){return b({status:!1})}}))};a(66);var O=function(){var e=Object(n.useState)([]),t=Object(d.a)(e,2),a=t[0],c=t[1];function o(e,t){return e.votes.length>t.votes.length?-1:e.votes.length<t.votes.length?1:0}return Object(n.useEffect)(function(){var e=localStorage.getItem("token");function t(){return(t=Object(m.a)(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.get("game",{headers:{Authorization:"Bearer ".concat(e)}});case 2:if(a=t.sent){t.next=5;break}return t.abrupt("return");case 5:c(a.data.sort(o));case 6:case"end":return t.stop()}},t)}))).apply(this,arguments)}!function(){t.apply(this,arguments)}()},[]),r.a.createElement("div",{className:"dashboard-container"},r.a.createElement("h1",null,"dashboard"),r.a.createElement(u.b,{to:"/"},r.a.createElement("button",{className:"sign-out"},"Go back")),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Id"),r.a.createElement("td",null,"Name"),r.a.createElement("td",null,"Votes"))),r.a.createElement("tbody",null,a.map(function(e){return r.a.createElement("tr",{key:e._id},r.a.createElement("td",null," ",e._id," "),r.a.createElement("td",null," ",e.name," "),r.a.createElement("td",null," ",e.votes.length," "))}))))};var x=function(){return r.a.createElement(u.a,null,r.a.createElement(s.a,{path:"/",exact:!0,component:v}),r.a.createElement(s.a,{path:"/main/:id",component:w}),r.a.createElement(s.a,{path:"/admin",component:O}))};a(69);var j=function(){return r.a.createElement("div",null,r.a.createElement(x,null))};o.a.render(r.a.createElement(j,null),document.getElementById("root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.cad4d3ec.chunk.js.map